<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>West Nile virus</title>

<head>
  <link rel="stylesheet" type="text/css" href="../css/style_new.css" media="screen" />
  <link rel="stylesheet" type="text/css" href="../css/style.css" media="screen" />
  <link rel="stylesheet" type="text/css" href="../css/base.css" media="screen" />
  <link rel="stylesheet" type="text/css" href="../css/adjust_base_on_width.css" media="screen" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">



  <style>
    /* .try {
        width: 20%;
        background-color: pink;
        margin: 50px auto;
    } */
    
    html {
        scroll-behavior: smooth;
    }

    .leftPanel {
      /* top: 220px; */
      left: 30px;
      float: left;
      position: relative;
    }


    /* how to navigate */
    .dialog {
      width: 1320px;
      height: 820px;
      padding: 5px;
      border: 0;
      border-radius: 0.5rem;
      box-shadow: hsl(0 0% 0% / 10%) 0 0 0.5rem 0.25rem;
      /* position: relative; */
      margin: auto;
    }

.dialog::backdrop {
  background: hsl(0 0% 0% / 50%);
}

.dialog-close-btn {
 appearance: none;
 background-color: transparent;
 border: 0.125em solid #1A1A1A;
 border-radius: 0.9375em;
 box-sizing: border-box;
 color: #3B3B3B;
 cursor: pointer;
 display: inline-block;
 font-family: Roobert,-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
 font-size: 16px;
 font-weight: 600;
 line-height: normal;
 margin: 0;
 min-height: 3.75em;
 min-width: 0;
 outline: none;
 padding: 1em 2.3em;
 text-align: center;
 text-decoration: none;
 transition: all 300ms cubic-bezier(.23, 1, 0.32, 1);
 user-select: none;
 -webkit-user-select: none;
 touch-action: manipulation;
 will-change: transform;

 position: absolute;
 bottom: 1em;
 right: 610px;
}

.dialog-close-btn:disabled {
 pointer-events: none;
}

.dialog-close-btn:hover {
 color: #fff;
 background-color: #1A1A1A;
 box-shadow: rgba(0, 0, 0, 0.25) 0 8px 15px;
 transform: translateY(-2px);
}

.dialog-close-btn:active {
 box-shadow: none;
 transform: translateY(0);
}

/* .dialog-close-btn {
  font-size: 1.3em;
  padding: 5px;
  width: 100px;
  height: 50px;
  position: absolute;
  bottom: .5em;
  right: 610px;
} */

.dialog-open-btn {
  border-radius: 6px;
  width: 240px;
  height: 40px;
  background-image: url(../images/standard_button_bg_2x_text.png);
  background-position: center;
  background-size: cover;
  border:none;
  /* position: fixed; */
  left: 3.5em;
  /* top: 1030px; */
  display: block;
  margin-top: 5px;
  margin-left: 6px;
  cursor: pointer;
}

    
  .link {
    /* position: fixed; */
    /*background: #e8e8e8;*/
    left: 3em;
    /* top: 312px; */
    padding: 1em;
    width: 18em;
    /*height: 100vh;*/
    line-height: 2;
    color: #111;
    display: inline-block;
    margin-bottom: 15px;
  }
/* 
  .link li a {
    text-decoration: none;
    font-size: 14px;
  } */


  /* Elevator */
  .xtx-elevator .xtx-elevator-list li a:hover,
  .xtx-elevator .xtx-elevator-list li a.active,
  .link li a:hover {
    display: inline-block;
    padding-left: 8px;
    font-weight: bold;
    /* font-size: 14pt; */
    color: #004987;
    border-left: 4px solid #004987;
    cursor: pointer;
}
    
    .xtx-elevator {
      /* position: fixed; */
      /* border-top: 1px solid #8b8b8b; */
      /*background: #e8e8e8;*/
      left: 3em;
      /* top: 660px; */
      display: inline-block;
      padding: 1em;
      padding-top: 5px;
      padding-bottom: 5px;
      width: 18em;
      /*height: 100vh;*/
      line-height: 1.5;
    }


    .xtx-elevator .elevator_title .icon {
      color: #333;
    }
    
    .xtx-elevator .elevator_title .text {
      padding: 3px 3px 3px 6px;
      font-size: 12pt;
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      color: #333;
    }
    
    .xtx-elevator li a,.link li a  {
      text-decoration: none;
      font-size: 12pt;
  }
  
    /* #home-button{
      position: fixed;
      top: 266px;
      left: 3em;
      z-index: 100;
  } */

    .link .button, .xtx-elevator .button{
      margin-bottom: 20px;
    }

    .button .text {
      padding: 3px 3px 3px 6px;
      font-size: 14pt;
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }
  
    .xtx-elevator .elevator_title span,
    .button span {
    display: inline-block;
    vertical-align: middle;
    }

    #home-button {
      cursor: pointer;
    }



  </style>
</head>

<body>
  
  <!-- Hero-image -->
  
  <div class="hero-image">
    <a class="image-logo" href="http://www.bccdc.ca/">
      <img src="../images/BCCDC_Logo_White_900px.png" alt="Left Logo" title="Left Logo">
    </a>
    <div class="image-text">
      <div class="bottom-text">West Nile Virus Surveillance</div>
    </div>
  </div>
  
  <!-- Hero-image end --> 


  <!-- Left panel --> 
   
  <div class="leftPanel">
    
    <!-- Elevator -->
            
    <div class="xtx-elevator">
      
      <!-- Back to top -->
      <div class = "button" id="backTop">
        <a href = "javascript:;">
          <button type="button" class="btn btn-default action-button">
            <span class="icon"><i class="fa-solid fa-list"></i></span>
            <span class = "text">Table of contents</span>
          </button>
        </a>
      </div>
      <!-- Back to top end -->
      
      <!-- <div class="elevator_title">
        <span class="icon"><i class="fa-solid fa-list"></i></span> <span class = "text">Table of content</span>
      </div> -->
      <ul class="xtx-elevator-list">
      <li><a href="javascript:;" data-name="topic1">West Nile Virus</a></li>
      <li><a href="javascript:;" data-name="topic2">Location of WNV Detections in British Columbia</a></li>
      <li><a href="javascript:;" data-name="topic3">Mosquito Surveillance</a></li>
      <li><a href="javascript:;" data-name="topic4">Supplementary information</a></li>
      </ul>
    </div>
    
    <!-- Elevator end -->
      <button id="openModal" class="dialog-open-btn"> </button>

    <dialog id="modal" class="dialog">
      <button id="closeModal" class="dialog-close-btn">Close</button>
      <!-- <button id="closeModal" class="dialog-close-btn">Close</button> -->
      <img id="image" src="../images/Webpage_navigation.png" alt="Click on button" />
    </dialog>

    </div>
  <!-- Left panel end-->

  <!-- <div style="height: 3000px; width: 800px; margin: 0 auto;background-color: aquamarine;">
    akfjal;jfl;ajf;al
  </div> -->

  <!-- js for left panel position -->
  <script>
    // get left panel element
    const leftPanel = document.querySelector('.leftPanel')
    // add scroll event listener
    window.addEventListener('scroll', function(){
      // when the scroll head is greater than 300
      const n = document.documentElement.scrollTop
      if (n >= 250) {
        leftPanel.style.position = "fixed";
        leftPanel.style.left = "30px";
        leftPanel.style.top = "30px";
      } else {
        leftPanel.style.position = "relative"
        leftPanel.style.left = "30px";
      }
    })
  </script>

  <!-- js for bootstrap model -->
  <script>
    const modal = document.querySelector("#modal");
    const openModal = document.querySelector("#openModal");
    const closeModal = document.querySelector("#closeModal");

    if (modal) {
      openModal &&
        openModal.addEventListener("click", () => modal.showModal());
        console.log(modal.showModal)
      closeModal &&
        closeModal.addEventListener("click", () => modal.close());
    }

  </script>

  <!-- js for Elevator-->
  <script>

  (function () {
      // 1. click and scroll
      const list = document.querySelector('.xtx-elevator-list')
      list.addEventListener('click', function (e) {
        // console.log(11)
        if (e.target.tagName === 'A' && e.target.dataset.name) {
          // get old active object
          const old = document.querySelector('.xtx-elevator-list .active')
          // check if old exist, if do, remove
          if (old) old.classList.remove('active')
          // add active to current object clicked
          e.target.classList.add('active')
          // the the position for big box
          const top = document.querySelector(`.section_${e.target.dataset.name}`).offsetTop
          // scroll the page
          console.log(top)
          document.documentElement.scrollTop = top

        }
      })


      // 2. add sctive for small box according to the position of big box
      window.addEventListener('scroll', function () {
        
        //  3.1  remove active class 
        // get the old active object
        const old = document.querySelector('.xtx-elevator-list .active')
        // check if old exist, if do, remove
        if (old) old.classList.remove('active')

        // 3.2 select small box according to the position

        // get four big box
        const topic1 = document.querySelector('.section_topic1')
        const topic2 = document.querySelector('.section_topic2')
        const topic3 = document.querySelector('.section_topic3')
        const topic4 = document.querySelector('.section_topic4')
   
   
        const n = document.documentElement.scrollTop
        if (n >= topic1.offsetTop && n < (topic2.offsetTop - 20)) {
    // Select first small box
    document.querySelector('[data-name=topic1]').classList.add('active')
} else if (n >= (topic2.offsetTop - 20) && n < (topic3.offsetTop - 20)) {
    // Select second small box
    document.querySelector('[data-name=topic2]').classList.add('active')
} else if (n >= (topic3.offsetTop - 20) && n < (topic4.offsetTop - 20)) {
    // Select third small box
    document.querySelector('[data-name=topic3]').classList.add('active')
} else if (n >= (topic4.offsetTop - 20)) {
    // Select fourth small box
    document.querySelector('[data-name=topic4]').classList.add('active')
}
      })

    })();

    // Back to top button
    const backTop = document.querySelector('#backTop')
    backTop.addEventListener('click', function(){
      document.documentElement.scrollTop = 0
    })

  </script>
  <!-- js for Elevator end -->
  
  <!-- js for idle time -->
  <script>
    function idleTimer() {
      var t = setTimeout(logout, 600000); // time is in milliseconds (1000 is 1 second)

      var socket_timeout_interval = setInterval(
          function () {Shiny.onInputChange('isActive', 'TRUE'); },
          120000
      );

      if (document.hasFocus()) {
        window.onmousemove = resetTimer; // catches mouse movements
        window.onmousedown = resetTimer; // catches mouse movements
        window.onclick = resetTimer;     // catches mouse clicks
        window.onscroll = resetTimer;    // catches scrolling
        // window.focus = resetTimer;
        // window.onkeypress = resetTimer;  //catches keyboard actions
      }

      function logout() {
          clearInterval(socket_timeout_interval);  //stop interval
          Shiny.onInputChange('isActive', 'FALSE');
      }

      function resetTimer() {
        clearTimeout(t);
        t = setTimeout(logout, 600000);  // time is in milliseconds (1000 is 1 second)
      }

    }

    idleTimer();
  </script>
  <!-- js for idle time end -->


</body>
<!-- HEAD_CONTENT -->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/style_new.css" type="text/css" />
<link rel="stylesheet" href="css/base.css" type="text/css" />
<link rel="stylesheet" href="css/adjust_base_on_width.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="section-header">




</div>


<!--Change idle time -->
<p><br></p>
<div
id="section-this-report-features-information-on-detections-of-west-nile-virus-wnv-in-human-and-animal-populations-in-british-columbia."
class="section level4 unlisted unnumbered">
<h4 class="unlisted unnumbered">This report features information on
detections of West Nile virus (WNV) in human and animal populations in
British Columbia.</h4>
</div>
<div
id="section-this-page-is-updated-as-cases-are-reported-last-updated-2025-06-02"
class="section level4">
<h4>This page is updated as cases are reported (Last Updated:
<strong>2025-06-02</strong>)</h4>
<p><br></p>
<div class="card bslib-card bslib-mb-spacing html-fill-item html-fill-container" data-bslib-card-init data-require-bs-caller="card()" data-require-bs-version="5" style="border: 1px solid #ccc; border-radius: 8px !important; font-family: &#39;Helvetica Neue&#39;&#10;             box-shadow: 2px 2px 6px rgba(0,0,0,0.1) !important; width: 100%;">
<div class="card-header">
<div style="background-color: #D3EDEF; color: black; padding: 10px; font-size: 18px; font-family: &#39;Helvetica Neue&#39;&#10;                     border-top-left-radius: 8px; border-top-right-radius: 8px; font-weight: bold; width: 100%;">Key Messages</div>
</div>
<div class="card-body bslib-gap-spacing html-fill-item html-fill-container" style="margin-top:auto;margin-bottom:auto;flex:1 1 auto;">
<ul style="padding: 10px;">
<li style="font-size: 16px; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, sans-serif; color: black; margin: 5px auto;">As of 7 March 2025:</li>
<li style="font-size: 16px; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, sans-serif; color: black; margin: 5px auto;"> - 0 human cases of WNV have been reported in BC in 2025</li>
<li style="font-size: 16px; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, sans-serif; color: black; margin: 5px auto;"> - 0 animals have tested positive for WNV in BC in 2025</li>
<li style="font-size: 16px; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, sans-serif; color: black; margin: 5px auto;"></li>
<li style="font-size: 16px; font-family: &#39;Helvetica Neue&#39;, Helvetica, Arial, sans-serif; color: black; margin: 5px auto;">The risk of acquiring WNV in BC remains low, with 0-2 locally-acquired cases reported each year. The best prevention against mosquito-borne diseases is preventing mosquito bites, and there are several tips you can use to keep safe while enjoying the outdoors.</li>
</ul>
</div>
<script data-bslib-card-init>bslib.Card.initializeAllCards();</script>
</div>
<p><br></p>
<p><img src="images/Line1_long.png" /></p>
<div class="section_topic1">

</div>
<div id="section-west-nile-virus" class="section level1">
<h1>West Nile Virus</h1>
<bslib-layout-columns class="bslib-grid grid bslib-mb-spacing html-fill-item" data-require-bs-caller="layout_columns()" data-require-bs-version="5">
<div class="bslib-grid-item bslib-gap-spacing html-fill-container">
<div class="card bslib-card bslib-mb-spacing html-fill-item html-fill-container" data-bslib-card-init data-require-bs-caller="card()" data-require-bs-version="5" width="4">
<div class="card-body bslib-gap-spacing html-fill-item html-fill-container" style="margin-top:auto;margin-bottom:auto;flex:1 1 auto;">
<p style="font-size: 16px; color: #004987;">WNV primarily affects birds, with corvids such as crows, jays, and magpies usually dying once infected. Humans and horses are incidental hosts for WNV and can get infected but are unable to transmit the virus to other animals or people. West Nile virus (WNV) surveillance in British Columbia has been conducted through testing horses, sick or dead corvids, and humans who have symptoms compatible with WNV. Blood and organ donations are also screened for WNV.</p>
</div>
<script data-bslib-card-init>bslib.Card.initializeAllCards();</script>
</div>
</div>
<div class="bslib-grid-item bslib-gap-spacing html-fill-container">
<div class="card bslib-card bslib-mb-spacing html-fill-container" data-bslib-card-init data-require-bs-caller="card()" data-require-bs-version="5" style="max-height:160px;" width="8">
<div class="card-body bslib-gap-spacing html-fill-item html-fill-container" style="margin-top:auto;margin-bottom:auto;flex:1 1 auto;">
<p style="font-size: 16px; margin: 0px !important; color:#004987; font-weight: bold;">WNV detections this year:</p>
<bslib-layout-columns class="bslib-grid grid bslib-mb-spacing html-fill-item" data-require-bs-caller="layout_columns()" data-require-bs-version="5" widths="4 4 4">
<div class="bslib-grid-item bslib-gap-spacing html-fill-container">
<div class="card bslib-card bslib-mb-spacing html-fill-item html-fill-container bslib-value-box default showcase-left-center" data-bslib-card-init data-require-bs-caller="card() value_box()" data-require-bs-version="5 5" style="border: 0px solid #003878; border-radius: 8px;">
<div class="card-body bslib-gap-spacing html-fill-item html-fill-container" style="margin-top:auto;margin-bottom:auto;flex:1 1 auto; padding:0;">
<div class="value-box-grid html-fill-item" style="--bslib-grid-height:auto;--bslib-grid-height-mobile:auto;---bslib-value-box-showcase-w:30%;---bslib-value-box-showcase-w-fs:1fr;---bslib-value-box-showcase-max-h:100px;---bslib-value-box-showcase-max-h-fs:67%;">
<div class="value-box-showcase html-fill-item html-fill-container">
<img src="www/person-icon.svg" height="50px"/>
</div>
<div class="value-box-area html-fill-item html-fill-container">
<div class="value-box-value html-fill-item html-fill-container">
<p style="font-size: 26px; font-weight: bold; margin: 0; text-align: center; color: #ffffff;">0</p>
<p style="font-size: 13px; margin: 0; text-align: center; color: #ffffff;">Human cases</p>
</div>
</div>
</div>
</div>
<script data-bslib-card-init>bslib.Card.initializeAllCards();</script>
</div>
</div>
<div class="bslib-grid-item bslib-gap-spacing html-fill-container">
<div class="card bslib-card bslib-mb-spacing html-fill-item html-fill-container bslib-value-box default showcase-left-center" data-bslib-card-init data-require-bs-caller="card() value_box()" data-require-bs-version="5 5" style="border: 0px solid #003878; border-radius: 8px;">
<div class="card-body bslib-gap-spacing html-fill-item html-fill-container" style="margin-top:auto;margin-bottom:auto;flex:1 1 auto; padding:0;">
<div class="value-box-grid html-fill-item" style="--bslib-grid-height:auto;--bslib-grid-height-mobile:auto;---bslib-value-box-showcase-w:30%;---bslib-value-box-showcase-w-fs:1fr;---bslib-value-box-showcase-max-h:100px;---bslib-value-box-showcase-max-h-fs:67%;">
<div class="value-box-showcase html-fill-item html-fill-container">
<img src="www/horse-icon.svg" height="50px"/>
</div>
<div class="value-box-area html-fill-item html-fill-container">
<div class="value-box-value html-fill-item html-fill-container">
<p style="font-size: 26px; font-weight: bold; margin: 0; text-align: center; color: #ffffff;">0</p>
<p style="font-size: 13px; margin: 0; text-align: center; color: #ffffff;">Positive horses</p>
</div>
</div>
</div>
</div>
<script data-bslib-card-init>bslib.Card.initializeAllCards();</script>
</div>
</div>
<div class="bslib-grid-item bslib-gap-spacing html-fill-container">
<div class="card bslib-card bslib-mb-spacing html-fill-item html-fill-container bslib-value-box default showcase-left-center" data-bslib-card-init data-require-bs-caller="card() value_box()" data-require-bs-version="5 5" style="border: 0px solid #003878;; border-radius: 8px;">
<div class="card-body bslib-gap-spacing html-fill-item html-fill-container" style="margin-top:auto;margin-bottom:auto;flex:1 1 auto; padding:0;">
<div class="value-box-grid html-fill-item" style="--bslib-grid-height:auto;--bslib-grid-height-mobile:auto;---bslib-value-box-showcase-w:30%;---bslib-value-box-showcase-w-fs:1fr;---bslib-value-box-showcase-max-h:100px;---bslib-value-box-showcase-max-h-fs:67%;">
<div class="value-box-showcase html-fill-item html-fill-container">
<img src="www/bird-icon.svg" height="50px"/>
</div>
<div class="value-box-area html-fill-item html-fill-container">
<div class="value-box-value html-fill-item html-fill-container">
<p style="font-size: 26px; font-weight: bold; margin: 0; text-align: center; color: #ffffff;">0</p>
<p style="font-size: 12px; margin: 0; text-align: center; color: #ffffff;">Positive corvids</p>
</div>
</div>
</div>
</div>
<script data-bslib-card-init>bslib.Card.initializeAllCards();</script>
</div>
</div>
</bslib-layout-columns>
</div>
<script data-bslib-card-init>bslib.Card.initializeAllCards();</script>
</div>
</div>
</bslib-layout-columns>
<div class="container-fluid">
<bslib-layout-columns class="bslib-grid grid bslib-mb-spacing html-fill-item" data-require-bs-caller="layout_columns()" data-require-bs-version="5">
<div class="bslib-grid-item bslib-gap-spacing html-fill-container">
<div class="card bslib-card bslib-mb-spacing bslib-card-input html-fill-item html-fill-container" data-bslib-card-init data-require-bs-caller="card()" data-require-bs-version="5" id="smallTabs">
<div class="card-body bslib-gap-spacing html-fill-item html-fill-container" style="margin-top:auto;margin-bottom:auto;flex:1 1 auto;">
<div class="tabbable">
<ul class="nav nav-tabs" data-tabsetid="1263">
<li class="active">
<a href="#tab-1263-1" data-toggle="tab" data-bs-toggle="tab" data-value="Human Cases">Human Cases</a>
</li>
<li>
<a href="#tab-1263-2" data-toggle="tab" data-bs-toggle="tab" data-value="Animal Detections">Animal Detections</a>
</li>
</ul>
<div class="tab-content" data-tabsetid="1263">
<div class="tab-pane active" data-value="Human Cases" id="tab-1263-1">
<div class="form-group shiny-input-container">
<label class="control-label" id="indicator_human-label" for="indicator_human">Select Indicator:</label>
<div>
<select id="indicator_human" class="shiny-input-select"><option value="Cases by location of acquisition" selected>Cases by location of acquisition</option>
<option value="Cases by clinical presentation">Cases by clinical presentation</option></select>
<script type="application/json" data-for="indicator_human" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item" id="epi_curve_human" style="width:100%;height:500px;"></div>
</div>
<div class="tab-pane" data-value="Animal Detections" id="tab-1263-2">
<div class="form-group shiny-input-container">
<label class="control-label" id="indicator_animal-label" for="indicator_animal">Select species:</label>
<select data-actions-box="true" data-noneSelectedText="Please select" data-state-input="true" id="indicator_animal" class="selectpicker form-control" autocomplete="off" multiple="multiple"><option value="Horses" selected>Horses</option>
<option value="Corvids" selected>Corvids</option>
<option value="Mosquito Pools" selected>Mosquito Pools</option></select>
</div>
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item" id="epi_curve_animal" style="width:100%;height:500px;"></div>
</div>
</div>
</div>
</div>
<script data-bslib-card-init>bslib.Card.initializeAllCards();</script>
</div>
</div>
</bslib-layout-columns>
</div>
<p><br></p>
</div>
<div id="section-location-of-wnv-detections-in-british-columbia"
class="section level1 section_topic2">
<h1>Location of WNV Detections in British Columbia</h1>
<div class="row">
<div class="col-sm-7">
<div class="form-group shiny-input-container">
<label class="control-label" id="slider-label" for="slider">Select Year(s):</label>
<input class="js-range-slider" id="slider" data-skin="shiny" data-type="double" data-min="2009" data-max="2025" data-from="2009" data-to="2025" data-step="1" data-grid="false" data-grid-snap="false" data-prettify-separator="" data-prettify-enabled="false" data-keyboard="true" data-drag-interval="false" data-data-type="number"/>
</div>
</div>
<div class="col-sm-5">
<div class="form-group shiny-input-container">
<label class="control-label" id="select_species-label" for="select_species">Select Species:</label>
<select data-actions-box="true" data-noneSelectedText="Please select" data-state-input="true" id="select_species" class="selectpicker form-control" autocomplete="off" multiple="multiple"><option value="Human" selected>Humans</option>
<option value="Horse" selected>Horses</option>
<option value="Corvid" selected>Corvids</option>
<option value="Mosquito Pool" selected>Mosquito Pools</option></select>
</div>
</div>
</div>
<div class="row">
<style type="text/css">#map {height: calc(84vh - 80px) !important;}</style>
<div class="leaflet html-widget html-widget-output shiny-report-size html-fill-item" id="map" style="width:100%;height:400px;"></div>
</div>
</div>
<br>
<div class="section_topic3">


<p><img src="images/Line1_long.png" /></p>
<div id="section-mosquito-surveillance" class="section level1">
<h1>Mosquito Surveillance</h1>
<div
id="section-from-2003-2014-the-bccdc-operated-a-comprehensive-wnv-surveillance-program-which-included-identifying-mosquito-breeding-areas-larval-and-adult-mosquito-monitoring-and-dead-corvid-testing.-at-the-time-the-program-was-initiated-wnv-was-present-in-neighbouring-jurisdictions-but-not-yet-present-in-bc.-active-mosquito-surveillance-was-discontinued-as-a-component-of-the-wnv-surveillance-program-after-2014.-throughout-the-course-of-this-program-wnv-was-detected-in-11-mosquito-pools-of-culex-tarsalis-in-the-south-okanagan-10-in-2009-1-in-2013."
class="section level4">
<h4>From 2003-2014, the BCCDC operated a comprehensive WNV surveillance
program which included identifying mosquito breeding areas, larval and
adult mosquito monitoring, and dead corvid testing. At the time the
program was initiated, WNV was present in neighbouring jurisdictions but
not yet present in BC. Active mosquito surveillance was discontinued as
a component of the WNV surveillance program after 2014. Throughout the
course of this program, WNV was detected in 11 mosquito pools of
<em>Culex tarsalis</em> in the South Okanagan (10 in 2009, 1 in
2013).</h4>
<!-- #### In the summer of 2024, ten years after routine mosquito surveillance was last conducted in the province, an 8-week pilot mosquito surveillance program was conducted in the Nanaimo and Osoyoos regions and captured mosquitoes were pathogen tested for Snowshoe hare and Jamestown Canyon viruses of the California serogroup in addition to WNV.   -->
<p><br></p>
<div class="row">
<div class="col-sm-4">
<div class="form-group shiny-input-container">
<label class="control-label" id="year-label" for="year">Select Year</label>
<div>
<select id="year" class="shiny-input-select"><option value="2014">2014</option>
<option value="2013">2013</option>
<option value="2012">2012</option>
<option value="2011">2011</option>
<option value="2010">2010</option>
<option value="2009">2009</option>
<option value="2008">2008</option>
<option value="2007">2007</option>
<option value="2006">2006</option>
<option value="2005">2005</option>
<option value="2004">2004</option>
<option value="2003" selected>2003</option></select>
<script type="application/json" data-for="year" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="col-sm-4">
<div class="shiny-panel-conditional" data-display-if="input.toggle_view == false" data-ns-prefix="">
<div class="form-group shiny-input-container">
<label class="control-label" id="m_specie_table-label" for="m_specie_table">Select Mosquito Species:</label>
<select data-actions-box="true" data-noneSelectedText="Please select a species" data-state-input="true" id="m_specie_table" class="selectpicker form-control" autocomplete="off" multiple="multiple"><option value="All species" selected>All species</option>
<option value="Aedes">Aedes</option>
<option value="Anopheles">Anopheles</option>
<option value="Coquillettidia">Coquillettidia</option>
<option value="Culex pipiens">Culex pipiens</option>
<option value="Culex tarsalis">Culex tarsalis</option>
<option value="Culex territans">Culex territans</option>
<option value="Culiseta">Culiseta</option></select>
</div>
</div>
<div class="shiny-panel-conditional" data-display-if="input.toggle_view == true" data-ns-prefix="">
<div class="form-group shiny-input-container">
<label class="control-label" id="m_specie_map-label" for="m_specie_map">Select Mosquito Species:</label>
<select data-noneSelectedText="Please select a species" data-state-input="true" id="m_specie_map" class="selectpicker form-control" autocomplete="off"><option value="All species" selected>All species</option>
<option value="Aedes">Aedes</option>
<option value="Anopheles">Anopheles</option>
<option value="Coquillettidia">Coquillettidia</option>
<option value="Culex pipiens">Culex pipiens</option>
<option value="Culex tarsalis">Culex tarsalis</option>
<option value="Culex territans">Culex territans</option>
<option value="Culiseta">Culiseta</option></select>
</div>
</div>
</div>
<div class="col-sm-4">
<div class="form-group shiny-input-container">
<label class="control-label" id="HSDA-label" for="HSDA">Select HSDA:</label>
<div>
<select id="HSDA" class="shiny-input-select" multiple="multiple"><option value="All HSDA&#39;s" selected>All HSDAs</option>
<optgroup label="Fraser Health">
<option value="Fraser East">Fraser East</option>
<option value="Fraser North">Fraser North</option>
<option value="Fraser South">Fraser South</option>
</optgroup>
<optgroup label="Vancouver Island">
<option value="Central Vancouver Island">Central Vancouver Island</option>
<option value="North Vancouver Island">North Vancouver Island</option>
<option value="South Vancouver Island">South Vancouver Island</option>
</optgroup>
<optgroup label="Interior Health">
<option value="Okanagan">Okanagan</option>
<option value="Thompson Cariboo Shuswap">Thompson Cariboo Shuswap</option>
<option value="East Kootenay">East Kootenay</option>
<option value="Kootenay Boundary">Kootenay Boundary</option>
</optgroup>
<optgroup label="Northern Health">
<option value="Northeast">Northeast</option>
<option value="Northern Interior">Northern Interior</option>
<option value="Northwest">Northwest</option>
</optgroup>
<optgroup label="Vancouver Coastal Health">
<option value="North Shore/Coast Garibaldi">North Shore/Coast Garibaldi</option>
<option value="Richmond">Richmond</option>
<option value="Vancouver">Vancouver</option>
</optgroup></select>
<script type="application/json" data-for="HSDA">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-6">
<div class="form-group shiny-input-container shiny-input-container-inline" style="display: inline-block; margin-right: 10px;">
<div class="material-switch">
<label for="toggle_view" style="padding-right: 10px;">Map View</label>
<input id="toggle_view" type="checkbox"/>
<label class="switch label-primary bg-primary" for="toggle_view"></label>
</div>
</div>
</div>
<div class="col-sm-6" align="right">
<a id="downloadTable" class="btn btn-default shiny-download-link disabled" href="" target="_blank" download aria-disabled="true" tabindex="-1">
<i class="fas fa-download" role="presentation" aria-label="download icon"></i>
Download Data
</a>
</div>
</div>
<div class="row">
<div class="shiny-panel-conditional" data-display-if="input.toggle_view == false" data-ns-prefix="">
<div class="col-sm-12">
<div class="datatables html-widget html-widget-output shiny-report-size html-fill-item" id="summaryTable" style="width:100%;height:auto;"></div>
</div>
</div>
<div class="shiny-panel-conditional" data-display-if="input.toggle_view == true" data-ns-prefix="">
<div class="col-sm-12">
<div class="leaflet html-widget html-widget-output shiny-report-size html-fill-item" id="mosquito_map" style="width:100%;height:680px;"></div>
</div>
</div>
</div>
<!-- Start of the custom panel -->
</div>
<div id="section-mosquitoes-of-british-columbia"
class="section level2 tabset custom-panel">
<h2 class="tabset">Mosquitoes of British Columbia</h2>
<div id="section-aedes-spp." class="section level3">
<h3><em>Aedes </em> spp.</h3>
<div class="sub_bullet">
<p><em>Aedes</em> species are typically the most abundant mosquitoes in
Canada and are numerous in BC. <em>Aedes</em> were the most collected
mosquitoes in all years of the active mosquito surveillance program that
ran from 2003 to 2014. These mosquitoes have a reputation as nuisance
pests, especially when flooding occurs, and the amount collected from
year to year varied depending on the amount of moisture accumulation and
snowmelt. There are both endemic and invasive <em>Aedes</em> species in
British Columbia. In 2014 the invasive species <em>Aedes japonicus</em>
was first detected in British Columbia.</p>
</div>
</div>
<div id="section-anopheles-spp." class="section level3">
<h3><em>Anopheles</em> spp.</h3>
<div class="sub_bullet">
<p><em>Anopheles</em> species are well known globally as the primary
vector of malaria, although this disease no longer endemic in Canada.
<em>Anopheles earlei</em> is one species that can be found across the
province and are vicious biters that are tolerant of cold temperatures
(Belton 2007).</p>
</div>
</div>
<div id="section-culex-spp." class="section level3">
<h3><em>Culex</em> spp.</h3>
<div class="sub_bullet">
<p><em>Culex</em> species are more often found infected with WNV than
any other group of mosquitoes across the North American continent, and
the two primary vector species that drive WNV activity in BC are
<em>Culex pipiens</em> and <em>Culex tarsalis</em>. WNV has been
detected in eleven <em>Culex tarsalis</em> mosquito pools in the South
Okanagan, with the first detection occurring in 2009.</p>
</div>
</div>
<div id="section-culiseta-spp." class="section level3">
<h3><em>Culiseta</em> spp.</h3>
<div class="sub_bullet">
<p>There are several <em>Culiseta</em> species present in BC, the most
common of which being <em>Culiseta incidens</em>. This species is well
adapted to urban areas and can be found near artificial containers, such
as catch basins, as well as drainage ditches.</p>
</div>
</div>
<div id="section-coquillettidia-spp." class="section level3">
<h3><em>Coquillettidia</em> spp.</h3>
<div class="sub_bullet">
<p><em>Coquillettidia perturbans</em> is the most well-known
<em>Coquillettidia</em> species and can be found near lakes and ponds
where aquatic plants, such as cattails, are present. Their larvae live
below the surface of the water and water temperature determines their
final stages in spring metamorphosis. In BC there is only one generation
of <em>Coquillettidia perturbans</em> per year and the adult population
was most abundant around the second to third week of July.</p>
</div>
</div>
</div>
<p><!-- End of custom panel --></p>
<div id="section-section" class="section level2 unnumbered">
<h2 class="unnumbered"></h2>
<p><img src="images/Line1_long.png" /></p>
</div>
</div>
<div id="section-supplementary-information"
class="section level1 tabset section_topic4">
<h1 class="tabset">Supplementary Information</h1>
<div id="section-data-notes" class="section level2">
<h2>Data notes</h2>
<div class="sub_bullet">
<p>Since the establishment of a provincial WNV surveillance system in
2002, a wide variety of partners have supported surveillance in BC
including the BCCDC, BC Ministry of Agriculture and Food’s Animal Health
Centre (AHC), the Office of the Provincial Health Officer (OPHO), the
Regional Health Authorities (RHAs), individual physicians,
veterinarians, municipal governments, mosquito control contractors, bird
banders, the Ministry of Health, the Ministry of Agriculture and Food,
Canadian Blood Services (CBS), BC Transplant, and the Public Health
Agency of Canada.</p>
<p><strong>Surveillance of WNV in Humans</strong></p>
<p>In accordance with established reporting practices for reportable
communicable diseases in humans, a laboratory notification is
communicated to the requesting physician as well as to the appropriate
Regional Health Authority for case follow-up to collect information
regarding clinical presentation and exposure history using a
standardized case report form. Cases are classified as West Nile
non-Neurological Syndrome (WN-non-NS), West Nile Neurological Syndrome
(WNNS), or West Nile Asymptomatic Syndrome (WNAI) according to both
self-reported symptoms and clinical information collected from the
patientâ€™s physician. Cases are further categorized as probable or
confirmed depending on clinical and laboratory evidence. Case geography
for locally acquired cases is based on the location of residence, which
may not reflect the location of disease acquisition.</p>
<p><strong>Surveillance of WNV in Horses</strong></p>
<p>Passive surveillance of WNV infection in horses was incorporated into
the provincial WNV surveillance system in 2009. Specimens from horses
suspected of being infected with the virus are collected by the
attending veterinarians and submitted for WNV testing at the AHC. Horses
that die or are euthanized after exhibiting neurological symptoms and
are submitted for diagnostic necropsy may also be tested for WNV. All
cases of equine WNv infection are reportable to the BCCDC as per
provincial legislation and regulation.</p>
<p><strong>Surveillance of WNV in Corvids</strong></p>
<p>Corvid surveillance was initially a key component of WNV surveillance
in BC and was actively conducted from 2002 - 2015. The RHAs were
responsible for the collection and submission of dead corvids to the AHC
where testing was completed (VecTestÂ® disptick test from 2002-2010,
replaced by polymerase chain reaction [PCR] testing from 2011 onwards).
To acquire samples of deceased corvids RHAs worked with municipal
governments, who coordinated with parks workers, the public, and even
the BC SPCA, to locate and collect samples. From 2004 to 2015, the BCCDC
also hosted an online reporting portal where members of the public could
report sightings of dead corvids though BC’s wild bird mortality line
where staff/contractors would be dispatched to collect and submit
reported corvids for testing. From 2015 onward, corvids are tested for
WNV if a cluster of mortalities is detected.</p>
<p><strong>Mosquito Trapping</strong></p>
<p>The number and geographic coverage of traps operated varied year to
year depending on resources and risk assessments based on findings from
previous surveillance years. Some traps were operated in more than one
location on two different days of the week. Traps were run overnight,
and the catches sent in coolers to BCCDC for identification and WNV
testing. Mosquito trapping was generally conducted from the first week
in June to the last week of October, a shortened interval from the first
three years of the program (2003-2005) in which trapping was initiated
in May. In 2012 and 2013 the trapping window was focused further, ending
in the second week of September. In the final year of the program (2014)
mosquito trapping ran from the beginning of July to the end of August
and was focused in the Okanagan Valley. Both CDC light traps (Ultra
Violet Blacklight) and gravid traps were utilized throughout the
program. Most of the light traps were baited with CO2 (from dry ice),
which mimics the presence of a host that female mosquitoes will be
seeking out in search of a blood meal.</p>
<p><strong>Mosquito Identification and Pathogen Testing</strong></p>
<p>Mosquito submissions were separated into sex and taxonomic groupings:
<em>Aedes</em>, <em>Anopheles</em>, <em>Coquillettidia</em>,
<em>Culiseta</em>, and <em>Culex</em>. Mosquitoes were sorted on a chill
table to prevent denaturation of any viral RNA and identified to genus
or (in the case of Culex) to species. Mosquitoes of the same identity
were pooled in groups of up to 50 mosquitoes per pool and tested for WNV
by PCR. Beginning in 2006, only female <em>Culex</em> mosquitoes were
tested. For large volume traps containing more than 500 mosquitoes, the
entire sample was sorted to selectively pick out all the female Culex
mosquitoes for PCR testing. Five hundred mosquitoes from large volume
traps were initially identified and reported; the remainder
(i.e. non-Culex species) was saved for identification at the end of the
season. A fraction of the remainder (Â½, Â¼, â…›, etc.) was identified
and the total number for each genus in the trap extrapolated.</p>
</div>
<p><br></p>
</div>
<div id="section-definitions" class="section level2">
<h2>Definitions</h2>
<div class="sub_bullet">
<p><strong>Locally acquired:</strong> A case who likely acquired their
infection inside of British Columbia based on a review of available
exposure history in addition to clinical and laboratory evidence. Cases
that acquired their infection within the province of British Columbia
but away from their place of residence (i.e. through travel within
British Columbia) are considered to be locally acquired for the purposes
of surveillance and reporting. Cases in horses are classified as locally
acquired if the horse did not travel off of their resident farm during
the incubation period.</p>
<p><strong>Travel-related:</strong> A case who likely acquired their
infection during travel outside of British Columbia based on a review of
available exposure history in addition to clinical and laboratory
evidence. Cases in horses are classified as travel-related if the horse
left their resident farm during the incubation period.</p>
</div>
<p><br></p>
</div>
<div id="section-abbreviations" class="section level2">
<h2>Abbreviations</h2>
<p><strong>BC:</strong> British Columbia</p>
<p><strong>BCCDC:</strong> British Columbia Centre for Disease
Control</p>
<p><strong>AHC:</strong> BC Ministry of Agriculture and Food’s Animal
Health Centre</p>
<p><strong>WNV:</strong> West Nile virus</p>
<p><strong>WN-non-NS:</strong> West Nile non-Neurological Syndrome</p>
<p><strong>WNAI:</strong> West Nile Asymptomatic Infection</p>
<p><strong>WNNS:</strong> West Nile Neurological Syndrome <br></p>
</div>
<div id="section-acknowledgements" class="section level2">
<h2>Acknowledgements</h2>
<p>The BC Centre for Disease Control provides services to a diverse
population including First Nations, MÃ©tis Peoples, and Inuit living in
various settings and communities across BC. As a provincial network, we
operate on the unceded traditional and ancestral lands of First Nations.
Our main office is located on the traditional and ancestral lands of the
xÊ·mÉ™Î¸kÊ·É™yÌ“É™m (Musqueum), SkÌ±wxÌ±wuÌ7mesh UÌxwumixw (Squamish
Nation), and sÉ™lilwÉ™taÉ¬ (Tseil-Waututh Nation).</p>
<p>Surveillance of mosquito-borne diseases is a shared responsibility
between partners in the human health, environmental health, and animal
health sectors. We gratefully acknowledge our partners at the regional
health authorities (Fraser Health, Interior Health, Island Health,
Northern Health, and Vancouver Coastal Health), BC Ministry of
Agriculture and Food’s Animal Health Centre, The BCCDC Public Health
Laboratory, BCCDC Data and Analytic Services, and Canadian Blood
Services for their continued collaboration.</p>
<p>All components of this report were developed using the R computing
language. Graphics and visualization were created using the tidyverse,
ggplot, shiny and plotly packages.</p>
<p>R Core Team (2021). R: A language and environment for statistical
computing. R Foundation for Statistical Computing, Vienna, Austria. URL
<a href="https://www.R-project.org/"
class="uri">https://www.R-project.org/</a>. <br></p>
</div>
<div id="section-references" class="section level2">
<h2>References</h2>
<p>Belton, P. (2007). British Columbia Mosquitoes as Vectors of West
Nile Virus. Available<br />
from <a href="http://www.sfu.ca/~belton/"
class="uri">http://www.sfu.ca/~belton/</a>. Accessed on April 14, 2025.
<br></p>
</div>
<div id="section-disclaimer" class="section level2">
<h2>Disclaimer</h2>
<p><strong>Terms of Use</strong></p>
<p>By using this dashboard, you understand and agree that:</p>
<p><strong>Disclaimer &amp; Limitation of Liability</strong></p>
<p>This dashboard, and data contained in it, are provided “as is”
without representations or warranties of any kind, either expressed or
implied, including but not limited to, representations or warranties
regarding the accuracy of the information in the dashboard and
associated data, implied warranties of merchantability and fitness for a
particular purpose, non-infringement or other violation of rights. The
British Columbia Centre for Disease Control operates in a live database
environment. Data are updated regularly and may change over time as the
source data feeds are refreshed. Information presented in this report
may not reflect the current situation, and therefore should only be used
for reference purposes. Access to this dashboard and associated data may
be suspended or discontinued, and the content of the dashboard may be
altered, in part or in whole, at any time and for any reason, with or
without prior notice, at the discretion of the British Columbia Centre
for Disease Control and the Provincial Health Services Authority. All
inferences, opinions, and conclusions drawn in this report are those of
the authors, and do not reflect the opinions or policies of the Data
Steward(s). Anyone using this information does so at their own risk. In
no event will the British Columbia Centre for Disease Control or the
Provincial Health Services Authority be liable for any direct, indirect,
special, punitive, incidental, or consequential damages arising from the
use of, or the inability to use, this dashboard.</p>
<p>Please direct questions and feedback to the BCCDC: <a
href="mailto:Admininfo@bccdc.ca"
class="email">Admininfo@bccdc.ca</a>.</p>
</div>
</div>
<p><br></p>
<p>
<script type="application/shiny-prerendered" data-context="server-start">

knitr::opts_chunk$set(echo      = FALSE)
knitr::opts_chunk$set(warning   = FALSE)
knitr::opts_chunk$set(message   = FALSE)
knitr::opts_chunk$set(fig.align = 'center')
library(rmarkdown)
library(magrittr)
library(scales)
library(lubridate)
library(ggplot2)
library(plotly)
library(sf)
library(dplyr)
library(shiny)
library(tidyr)
library(tibble)
library(shinyalert)
library(tidyverse)
library(janitor)
library(stringr)
library(gt)
library(here)
library(rio)
library(bcmaps)
library(tmap)
library(DT)
library(writexl)
library(readxl)
library(here)

# Quinn's app

library(rlang)
library(shinyWidgets)
library(leaflet)
library(bslib)
library(shinyjs)
library(rmapshaper)
library(prettymapr)
library(bsicons)

</script>
 
<script type="application/shiny-prerendered" data-context="server">

keep_alive <- shiny::reactiveTimer(
  intervalMs = 120000,
  session    = shiny::getDefaultReactiveDomain()
  )

shiny::observe(
  {
    if(req(input$isActive) %>% as.logical) keep_alive()
    }
  )

</script>


<script type="application/shiny-prerendered" data-context="data">



data_notes_outbreak <- 
  readLines(
    'www/data_notes_outbreak.txt'
  )

definitions_outbreak <- 
  readLines(
    'www/definitions_outbreak.txt'
)

abbreviations_outbreak <- 
  readLines(
    'www/abbreviations_outbreak.txt'
  )

disclaimer_outbreak <- 
  readLines(
    'www/disclaimer_outbreak.txt'
  )

references <- 
  readLines(
    'www/references.txt'
)

acknowledgements_outbreak <-
  readLines(
    'www/acknowledgements_outbreak.txt'
  )

aedes <-
  readLines(
    'www/aedes.txt'
  )

anopheles <-
  readLines(
    'www/anopheles.txt'
  )

coquilletidia <-
  readLines(
    'www/coquillettidia.txt'
  )

culex <-
  readLines(
    'www/culex.txt'
  )

culiseta <-
  readLines(
    'www/culiseta.txt'
  )

####### WEST NILE VIRUS

# Epi Curve Data Load

animal_wnv_cases <- import(here("data", "Animal WNv Cases.xlsx"))
human_wnv_cases <- import(here("data", "Human WNv Cases.xlsx"))


# Define full year range (modify as needed)
full_years <- seq(
  min(c(human_wnv_cases$Year, animal_wnv_cases$Year), na.rm = TRUE),
  max(format(Sys.Date(), "%Y"), max(c(human_wnv_cases$Year, animal_wnv_cases$Year), na.rm = TRUE)),
  by = 1
)

# Define custom colors
custom_colors <- c(
  "Travel-related" = "#98AF57",  
  "Locally acquired" = "#2980B9",  
  "Unknown" = "#808080",  
  "West Nile Neurological Syndrome" = "#0B4C87",  
  "West Nile non-Neurological Syndrome" = "#2980B9",  
  " West Nile Asymptomatic Infection" = "#9DC8e9", 
  "Unspecified" = "grey",
  "Corvids" = "#f4ac28",  
  "Horse" = "#4a3a5a", 
  "Mosquito Pools" = "#93384A",
  "Horses (locally acquired)" = "#4C647E",
  "Horses (travel-related)" = "#8098B4"
)


####### LOCATION OF WNV DETECTIONS IN BRITISH COLUMBIA 

#local detections in Animals
WNV_Animal <- animal_wnv_cases %>%
  clean_names()%>%
  filter(travel != "Yes")%>%
  select(year, lha, animal_type)

#locally-acquired human cases
WNV_Human <- human_wnv_cases %>%
  clean_names()%>%
  filter(travel %in% c("No", "NO", "no"))%>%
  mutate(animal_type = "Human") %>%
  select(year, lha, animal_type)

#merge
WNV_detections = WNV_Human %>%
  bind_rows(WNV_Animal)

#basemap of LHAs
lha <- bcmaps::health_lha(ask = FALSE, force = FALSE)%>%
        st_transform(crs = 4326) %>%
        rmapshaper::ms_simplify(keep = 0.05, keep_shapes = TRUE)



######## MOSQUITO SURVEILLANNCE

# Map and Table Data Upload

# Loading shapefiles 

HSDA_layer <- bcmaps::health_hsda(ask = FALSE, force = FALSE)%>%
        st_transform(crs = 4326) %>%
        rmapshaper::ms_simplify(keep = 0.05, keep_shapes = TRUE)


HA_layer <- bcmaps::health_ha(ask = FALSE, force = FALSE)%>%
        st_transform(crs = 4326) %>%
        rmapshaper::ms_simplify(keep = 0.05, keep_shapes = TRUE)


# loading dataset

file_path <- here("data", "Summary of Mosquito Surveillance 2003-2014.xlsx")

# Get all sheet names (M2003 - M2014)
sheet_names <- excel_sheets(file_path)

# Function to read a sheet and add the "Year" column
read_and_label <- function(sheet) {
  year <- as.numeric(gsub("M", "", sheet))  # Extract numeric year from sheet name
  import(file_path, which = sheet) %>%
    mutate(Year = year)  # Add Year column
}

# Read all sheets and combine into one df
mosquito_count_reports <- bind_rows(lapply(sheet_names, read_and_label)) %>%
  rename(HSDA = `HSDA Code`,
         Coquillettidia = `Coquilletidia perturbans`) %>%
  filter(`HSDA ID` != 99) %>%
  select(- c(`HSDA ID`, `Culex unknown species`))


mosquito_count_reports1 <- mosquito_count_reports %>%
  mutate(HSDA = dplyr::case_when(
    HSDA == "CVI" ~ "Central Vancouver Island",
    HSDA == "EK" ~ "East Kootenay",
    HSDA == "FE" ~ "Fraser East",
    HSDA == "FN" ~ "Fraser North",
    HSDA == "FS" ~ "Fraser South",
    HSDA == "KB" ~ "Kootenay Boundary",
    HSDA == "NE" ~ "Northeast",
    HSDA == "NI" ~ "Northern Interior",
    HSDA == "NSCG" ~ "North Shore/Coast Garibaldi",
    HSDA == "NVI" ~ "North Vancouver Island",
    HSDA == "NW" ~ "Northwest",
    HSDA == "OK" ~ "Okanagan",
    HSDA == "RICH" ~ "Richmond",
    HSDA == "SVI" ~ "South Vancouver Island",
    HSDA == "TCS" ~ "Thompson Cariboo Shuswap",
    HSDA == "VAN" ~ "Vancouver"))


# defining input variables

current_year <- as.numeric(format(Sys.Date(), "%Y"))
# years <- seq(current_year, 2003, by = -1 )
years <- c(#2024, 
           2014:2003)

Culex <- c("Culex pipiens",	"Culex tarsalis",	"Culex territans")
species <- c("All species", "Aedes",	"Anopheles", "Coquillettidia", Culex, "Culiseta")

# Define grouped HSDA structure
HSDA_groups <- list(
  "All HSDAs" = "All HSDA's", 
  "Fraser Health" = c("Fraser East", "Fraser North", "Fraser South"),
  "Vancouver Island" = c("Central Vancouver Island", "North Vancouver Island", "South Vancouver Island"),
  "Interior Health" = c("Okanagan", "Thompson Cariboo Shuswap", "East Kootenay", "Kootenay Boundary"),
  "Northern Health" = c("Northeast", "Northern Interior", "Northwest"),
  "Vancouver Coastal Health" = c("North Shore/Coast Garibaldi", "Richmond", "Vancouver")
)

# Reconstruct `HSDA_full_names` from `HSDA_groups` so the server code works without modification
HSDA_full_names <- unlist(HSDA_groups, use.names = FALSE)

# Recreate `HSDA_reverse_map` where each HSDA maps to itself.
HSDA_reverse_map <- setNames(HSDA_full_names, HSDA_full_names)



</script>
 
<script type="application/shiny-prerendered" data-context="server">

#Epi curve server

human_title <- reactive({
    paste("Human Cases of West Nile virus in British Columbia by", 
         tools::toTitleCase(gsub("Cases by ", "", input$indicator_human))) 
  })
  
animal_title <- reactive({
  selected <- input$indicator_animal
  
  if (length(selected) == 1) {
    paste("Animal Cases of West Nile virus in British Columbia for", selected)
  } else {
    paste("Animal Cases of West Nile virus in British Columbia by Species")
  }
})
  

  # Reactive Data Filtering for Human Cases
  human_data <- reactive({
    data <- human_wnv_cases
    
    if (input$indicator_human == "Cases by location of acquisition") {
      data <- data %>%
        mutate(Category = case_when(
          Travel == "Yes" ~ "Travel-related",
          Travel == "No" ~ "Locally acquired",
          TRUE ~ "Unknown"
        )) %>%
        group_by(Year, Category) %>%
        summarise(Cases = n(), .groups = "drop") %>%
        complete(Year = full_years, Category, fill = list(Cases = 0)) %>%  
        mutate(Description = paste(
          Cases, ifelse(Cases == 1, "case", "cases"), "of WNv", ifelse(Cases == 1, "was", "were"), "reported in people with",
          ifelse(Category == "Travel-related", "history of travel, outside of British Columbia", "no travel history"),
          "in", Year
        ))
      
    } else if (input$indicator_human == "Cases by clinical presentation") {
      data <- data %>%
        mutate(`Disease classification` = case_when(
          `Disease classification` == "WNNS" ~ "West Nile Neurological Syndrome",
          `Disease classification` == "WN non-NS" ~ "West Nile non-Neurological Syndrome",
          `Disease classification` == "WNAI" ~ " West Nile Asymptomatic Infection",
          TRUE ~ "Unspecified")) %>%
        group_by(Year, Category = `Disease classification`) %>%
        summarise(Cases = n(), .groups = "drop") %>%
        complete(Year = full_years, Category, fill = list(Cases = 0)) %>% 
        mutate(Description = paste(
          Cases, ifelse(Cases == 1, "case", "cases"),"of WNv", ifelse(Cases == 1, "was", "were"), "reported with", Category, "in", Year
        ))
    }
    
    return(data)
  })
  
  
  # Reactive Data Filtering for Animal Cases
animal_data <- reactive({
  data <- animal_wnv_cases
  
  if (is.null(input$indicator_animal) || length(input$indicator_animal) == 0) {
    showNotification("Please select at lease one species.", duration = 2, type = "warning")
    return(NULL)
  }
  
  selected_animals <- input$indicator_animal
  
  data <- data %>%
    filter(`Animal Type` %in% c("Horse", "Corvid", "Mosquito Pool"))
  
  data <- data %>%
    mutate(Category = case_when(
      `Animal Type` == "Horse" & Travel == "Yes" ~ "Horses (travel-related)",
      `Animal Type` == "Horse" & Travel == "No" ~ "Horses (locally acquired)",
      `Animal Type` == "Corvid" ~ "Corvids",
      `Animal Type` == "Mosquito Pool" ~ "Mosquito Pools",
      TRUE ~ "Unknown"
    ))
  
  data <- data %>%
    filter(
      (("Horses" %in% selected_animals & grepl("Horses", Category)) |
       ("Corvids" %in% selected_animals & Category == "Corvids") |
       ("Mosquito Pools" %in% selected_animals & Category == "Mosquito Pools"))
    ) %>%
    group_by(Year, Category) %>%
    summarise(Cases = n(), .groups = "drop") %>%
    complete(Year = full_years, Category, fill = list(Cases = 0)) %>%
    mutate(Description = paste(
      Cases, ifelse(Cases == 1, "case", "cases"), "of WNv in", Category, "in", Year
    ))
  
  return(data)
})

  
  # Stacked Bar Chart for Human Cases
  output$epi_curve_human <- renderPlotly({
    req(human_data())  
    
  plot_ly(
    data = human_data(),
    x = ~Year,
    y = ~Cases,
    color = ~Category,
    text = ~Description,
    type = 'bar',
    hoverinfo = 'text',
    colors = custom_colors) %>% 
  layout(
    title = list(text = human_title(), 
                 font = list(size = 18, 
                             family = 'Helvetica Neue', 
                             color = '#808080', 
                             weight = 'bold'),
                 x = 0.5 ), # Center the title
    xaxis = list(
      title = list(text = 'Year', font = list(size = 14, family = 'Helvetica Neue', color = 'grey')),
      tickangle = 90,
      tickvals = seq(min(human_data()$Year, na.rm = TRUE), max(human_data()$Year, na.rm = TRUE), by = 1),
      zeroline = FALSE),
    yaxis = list(
      title = list(text = 'Cases', font = list(size = 14, family = 'Helvetica Neue', color = 'grey')),
      range = c(0, 24),
      tickvals = seq(0, 24, by = 2),
      gridcolor = 'dark grey'
    ),
    barmode = 'stack',  
    plot_bgcolor = 'white',
    paper_bgcolor = 'white',
    legend = list(
      title = list(text = "Click to add or remove:", font = list(size = 12, color = 'black')),
      orientation = "h",  # Set legend to horizontal
      x = 0.4,  # Center legend horizontally
      y = 1.1, # Move legend below the title
      xanchor = "center"
      #yanchor = "top"
    ),
    margin = list(t = 100)  
      ) %>% 
  config(
        displayModeBar = TRUE, 
        displaylogo = FALSE,  
        modeBarButtonsToRemove = c( 'pan2d', 'select2d', 'lasso2d')  # Remove unnecessary buttons
      ) 
  })
  
  # Stacked Bar Chart for Animal Cases
  output$epi_curve_animal <- renderPlotly({
    req(animal_data())
    
plot_ly(
  data = animal_data(),
  x = ~Year,
  y = ~Cases,
  color = ~Category,
  text = ~Description,
  type = 'bar',
  hoverinfo = 'text',
  colors = custom_colors
) %>% 
  layout(
    title = list(text = animal_title(), font = list(size = 18, family = 'Helvetica Neue', color = '#808080', weight = 'bold'),
                 x = 0.5  # Center the title
                 ),
    xaxis = list(
      title = list(text = 'Year', font = list(size = 14, family = 'Helvetica Neue', color = 'grey')),
      tickangle = 90,
      tickvals = seq(min(animal_data()$Year, na.rm = TRUE), max(animal_data()$Year, na.rm = TRUE), by = 1),
      zeroline = FALSE
    ),
    yaxis = list(
      title = list(text = 'Cases', font = list(size = 14, family = 'Helvetica Neue', color = 'grey')),
      range = c(0, 18),
      tickvals = seq(0, 18, by = 2),
      gridcolor = 'dark grey'
    ),
    barmode = 'stack',  # Stacked bar chart
    plot_bgcolor = 'white',
    paper_bgcolor = 'white',
    legend = list(
      title = list(text = "Click to add or remove:", font = list(size = 12, color = 'black')),
      orientation = "h",  # Set legend to horizontal
      x = 0.5,  # Center legend horizontally
      y = 1.1, # Move legend below the title
      xanchor = "center",
      yanchor = "top"
    ),
    margin = list(t = 100)  
      ) %>% 
  config(
        displayModeBar = TRUE, 
        displaylogo = FALSE, 
        modeBarButtonsToRemove = c('zoom2d', 'pan2d', 'select2d', 'lasso2d')  # Remove unnecessary buttons
      )

  })


</script>


<script type="application/shiny-prerendered" data-context="server">

#create reactive data for map
    reactive_data_map = reactive({
      
      req(input$slider)
      
       WNV_detections%>%
        group_by(lha)%>%
        filter(between(year,input$slider[1],input$slider[2]),
               animal_type %in% (input$select_species))%>%
        count()%>%
        right_join(., lha, by = c("lha" = "LOCAL_HLTH_AREA_NAME"))%>%
        # filter(HLTH_AUTHORITY_NAME %in% (input$select_HA))%>%
      mutate(n = replace_na(n, 0))})
  
    #map
     
          output$map = renderLeaflet ({
       leaflet(lha) %>%
       addTiles() %>%
       setView(lng = -122.649791, lat = 52.813212, zoom = 6)%>%
       addLegend(
         colors = c('#E2E2E2', '#fcba97', '#D67229', '#8d4004', "#421f03"),
         values = c("0", "1-4", "5-9", "10-14", "15+"),
         labels = c("0", "1-4", "5-9", "10-14", "15+"),
         opacity = 0.8,
         title = " <center> WNv <br> Detections",
         position = "bottomleft")})

     observe({
       
       #labels to show on hover of LHA
       labels = case_when(input$slider[1] == input$slider[2] ~ sprintf(
         "<strong> %s<\u002fstrong><br/> Year: %s<\u002fstrong><br/>West Nile virus detections: %g",
         reactive_data_map()$lha,
         input$slider[1],
         reactive_data_map()$n),
         input$slider[1] != input$slider[2] ~ sprintf(
           "<strong> %s<\u002fstrong><br/> Years: %s<\u002fstrong> - %s<\u002fstrong><br/>West Nile virus detections: %g",
           reactive_data_map()$lha,
           input$slider[1],
           input$slider[2],
           reactive_data_map()$n))%>%
         lapply(htmltools::HTML)

        #add polygons
       
        map = leafletProxy("map", data = reactive_data_map()) %>%
          clearShapes() %>%
          clearMarkers()
        
        req(input$select_species %in% c("Human", "Horse", "Corvid", "Mosquito Pool"))
        map %>% addPolygons(
            data = reactive_data_map()$geometry,
            fillColor = case_when(reactive_data_map()$n >= 1 & reactive_data_map()$n <=4 ~ "#fcba97",
                                          reactive_data_map()$n >= 5 & reactive_data_map()$n <=9 ~ "#D67229",
                                          reactive_data_map()$n >= 10 & reactive_data_map()$n <=14 ~ "#8d4004",
                                          reactive_data_map()$n >= 15 ~ "#421f03",
                                          reactive_data_map()$n == 0 ~ "#E2E2E2"),
                    weight = 1,
                    opacity = 0.8,
                    color = "#696868",
                    fillOpacity = case_when(reactive_data_map()$n == 0 ~ 0.7,
                                            reactive_data_map()$n > 0 ~ 0.8),
          highlightOptions = highlightOptions( #outline of FSAs on hover
            weight = 4,
            color = "#46ebeb",
            fillOpacity = 0.7,
            bringToFront = TRUE),
          label = labels)
  }
)

</script>
 
<script type="application/shiny-prerendered" data-context="server">

# MOSQUITO TABLE & MAP SERVER

selected_species <- reactive({
  if (input$toggle_view) {
    input$m_specie_map  # Single-select for map
  } else {
    input$m_specie_table  # Multi-select for table
  }
})

observeEvent(input$m_specie_table, {
  if ("All species" %in% input$m_specie_table && length(input$m_specie_table) > 1) {
    updatePickerInput(session, "m_specie_table", selected = "All species")
    showNotification("Cannot select 'All species' with other species. Reset to 'All species'.", duration = 2, type = "warning")
  }
})

observeEvent(input$HSDA, {
  if ("All HSDA's" %in% input$HSDA && length(input$HSDA) > 1) {
    updateSelectInput(session, "HSDA", selected = "All HSDA's")
    showNotification("Cannot select 'All HSDA's' with other HSDAs. Reset to 'All HSDA's'.", duration = 2, type = "warning")
  }
})

observeEvent(input$year, {
  if (input$year %in% 2009:2014) {
    cul <- c("Culex pipiens", "Culex tarsalis")
  } else {
    cul <- c("Culex pipiens", "Culex tarsalis", "Culex territans")
  }
  
  species_choices <- c("All species", "Aedes", "Anopheles", "Coquillettidia", cul, "Culiseta")
  
  table_selection <- input$m_specie_table
  map_selection <- input$m_specie_map
  
  
  updated_table_selection <- intersect(table_selection, species_choices)
  if (length(updated_table_selection) == 0) {
    updated_table_selection <- "All species"
  }
  
  updated_map_selection <- if (map_selection %in% species_choices) {
    map_selection
  } else {
    "All species"
  }
  
  updatePickerInput(session, "m_specie_table", choices = species_choices, selected = updated_table_selection)
  updatePickerInput(session, "m_specie_map", choices = species_choices, selected = updated_map_selection)
})



filtered_data_table <- reactive({
  if (is.null(input$HSDA) || length(input$HSDA) == 0) {
  showNotification("Please select at least one HSDA.", duration = 2, type = "warning")
  return(NULL)
}
  mosquito_count_reports1 %>%
    filter(Year == input$year) %>%
    filter(HSDA %in% if ("All HSDA's" %in% input$HSDA) HSDA_full_names[-1] else input$HSDA)
})

  

# Reactive expression for summary table for m_species
summary_table <- reactive({
  req(filtered_data_table()) 
  
  data <- filtered_data_table()
  species <- selected_species()
  raw_species <- species  # Store original selection before modifying
  

  # stops the error message by:
  # Removing "All species" from the output if "All species" is selected
  if ("All species" %in% species) {
    species <- setdiff(species, "All species") }

  # Handle special case where Culex territans shouldn't be summarized
  include_territans <- input$year %in% 2003:2008
  
  if (length(raw_species) == 1 && raw_species == "All species") {
  if (include_territans) {
    # Include Culex territans
    data %>%
      group_by(HSDA) %>%
      summarize(
        Aedes = round(sum(Aedes, na.rm = TRUE), 0),
        Anopheles = round(sum(Anopheles, na.rm = TRUE), 0),
        Coquillettidia = round(sum(Coquillettidia, na.rm = TRUE), 0),
        `Culex pipiens` = round(sum(`Culex pipiens`, na.rm = TRUE), 0),
        `Culex tarsalis` = round(sum(`Culex tarsalis`, na.rm = TRUE), 0),
        `Culex territans` = round(sum(`Culex territans`, na.rm = TRUE), 0),
        Culiseta = round(sum(Culiseta, na.rm = TRUE), 0),
        Total = round(sum(
          Aedes, Anopheles, Coquillettidia, `Culex pipiens`,
          `Culex tarsalis`, `Culex territans`, Culiseta,
          na.rm = TRUE
        ), 0),
        .groups = "drop"
      )
  } else {
    # Exclude Culex territans
    data %>%
      group_by(HSDA) %>%
      summarize(
        Aedes = round(sum(Aedes, na.rm = TRUE), 0),
        Anopheles = round(sum(Anopheles, na.rm = TRUE), 0),
        Coquillettidia = round(sum(Coquillettidia, na.rm = TRUE), 0),
        `Culex pipiens` = round(sum(`Culex pipiens`, na.rm = TRUE), 0),
        `Culex tarsalis` = round(sum(`Culex tarsalis`, na.rm = TRUE), 0),
        Culiseta = round(sum(Culiseta, na.rm = TRUE), 0),
        Total = round(sum(
          Aedes, Anopheles, Coquillettidia, `Culex pipiens`,
          `Culex tarsalis`, Culiseta,
          na.rm = TRUE
        ), 0),
        .groups = "drop"
      )
  }
} else {

  if (length(species) == 0) {
    return(tibble(HSDA = unique(data$HSDA)))
  }
    
    data %>%
      group_by(HSDA) %>%
      summarize(
        across(all_of(species), ~ round(sum(.x, na.rm = TRUE), 0)),
        .groups = "drop"
      )
  }

})


# Render the summary table (Output 1)
output$summaryTable <- DT::renderDataTable({
  req(summary_table())
  
  summary_table() %>%
    mutate(
      HSDA = ifelse(HSDA %in% HSDA_full_names, HSDA, "Unknown HSDA"),
      across(where(is.numeric), as.integer) 
    ) %>%
    DT::datatable(
      options = list(
        paging = FALSE,         
        searching = FALSE,      
        ordering = FALSE,      
        #scrollY = TRUE, 
        scrollX = TRUE, #new addition
        #autoWidth = TRUE, 
        dom = 'tr',
        class = 'compact',  
        columnDefs = list(
          list(className = 'dt-left', targets = 0),  
          list(className = 'dt-center', targets = "_all")  
        )
      ),
      rownames = FALSE
    ) %>%
    
    formatStyle(
      columns = colnames(summary_table()),
      textAlign = 'center' #change the table enteries, center, left, right.
      #`vertical-align` = "bottom"
      #fontWeight = 'bold'
    ) %>%
    
    formatStyle(
      "HSDA",  
      textAlign = 'left'
    ) 
})



output$downloadTable <- downloadHandler(
  filename = function() {
    paste("Mosquito_Surveillance_", input$year, ".xlsx", sep = "")
  },
  content = function(file) {
    write_xlsx(summary_table(), file)  
  }
)

#map server code - reactive expression for filtered data (year, HSDA)
filtered_data_map <- reactive({
  merged_data <- HSDA_layer %>%
    dplyr::left_join(mosquito_count_reports1, 
                     by = c("HLTH_SERVICE_DLVR_AREA_NAME" = "HSDA")) %>%
    filter(Year == input$year)%>%
    filter(HLTH_SERVICE_DLVR_AREA_NAME %in% 
             if ("All HSDA's" %in% input$HSDA) HSDA_full_names 
           else input$HSDA) %>%
    group_by(HLTH_SERVICE_DLVR_AREA_NAME, Year) %>%
    ungroup() %>%
    select(HLTH_SERVICE_DLVR_AREA_NAME, Year, geometry, Aedes, Anopheles, Coquillettidia, 
           `Culex pipiens`,	`Culex tarsalis`,	`Culex territans`, Culiseta, Total) %>%
    rename(HSDA = HLTH_SERVICE_DLVR_AREA_NAME)
  
  # Check if dataset is empty
  if (nrow(merged_data) == 0) {
    showNotification("Please select at least one HSDA.", duration = 2, type = "warning")
    return(NULL)
  }
  
  species <- selected_species()

if (!(length(species) == 1 && species == "All species")) {
  merged_data <- merged_data %>%
    mutate(`Selected Total` = rowSums(across(all_of(species)), na.rm = TRUE))
}

  
  # Convert to sf object
  st_as_sf(merged_data)
})


# Reactive expression for summary computation for m_species
map_summary <- reactive({
  data1 <- filtered_data_map()
  species <- selected_species()  # replace input$m_specie

  if (is.null(data1) || nrow(data1) == 0) {
    return(NULL) 
  }

# If multiple species selected for the table, automatically reset to "All species" when switched to map view
  if (length(species) != 1 || species == "All species") {
    species <- "All species"  # Force it for the map summary
  }

  if (species == "All species") {
    data1 %>%
      group_by(HSDA, Year) %>%
      summarize(
        Aedes = round(sum(Aedes, na.rm = TRUE), 0),
        Anopheles = round(sum(Anopheles, na.rm = TRUE), 0),
        Coquillettidia = round(sum(Coquillettidia, na.rm = TRUE), 0),
        `Culex pipiens` = round(sum(`Culex pipiens`, na.rm = TRUE), 0),
        `Culex tarsalis` = round(sum(`Culex tarsalis`, na.rm = TRUE), 0),
        `Culex territans` = round(sum(`Culex territans`, na.rm = TRUE), 0),
        Culiseta = round(sum(Culiseta, na.rm = TRUE), 0),
        Total = round(sum(Aedes, Anopheles, Coquillettidia, `Culex pipiens`, 
                          `Culex tarsalis`, `Culex territans`, Culiseta, na.rm = TRUE), 0),
        .groups = "drop"
      )
  } else {
    data1 %>%
      group_by(HSDA, Year) %>%
      summarize(
        `Total Cases` = round(sum(.data[[species]], na.rm = TRUE), 0),
        .groups = "drop"
      )
  }
})


observeEvent(input$toggle_view, {
  if (input$toggle_view) {
    
    if (length(input$m_specie_table) > 1) {
      updatePickerInput(session, "m_specie_map", selected = "All species")
      
      showNotification("Reverting to All species for map view.", type = "message")
    } else {
      updatePickerInput(session, "m_specie_map", selected = input$m_specie_table)
    }
  }
})


# Render the interactive map using leaflet (Output 2)

output$mosquito_map <- renderLeaflet({
  req(map_summary())  

  #Determine which colour to use for coloring
  species_col <- if (length(selected_species()) == 1 && selected_species() == "All species") {
  "Total"
} else {
  "Selected Total"
}
  
  data <- filtered_data_map()
  
  # Check if data is available
  if (is.null(data) || nrow(data) == 0) {
    showNotification("No data available for the selected filters.", duration = 2, type = "warning")
    
    return(leaflet() %>%
             addTiles() %>%
             setView(lng = -122.649791, lat = 52.813212, zoom = 6))
  }
  
  # Check if the species column exists
if (!(species_col %in% colnames(data))) {
  showNotification("Selected species data is unavailable.", duration = 2, type = "error")
  return(NULL)
}

# Check if the selection results in all NA values
if (!(species_col %in% colnames(data)) || all(is.na(data[[species_col]]) | data[[species_col]] == 0)) {

  showNotification(
    paste0("Error: ", paste(selected_species(), collapse = ", "), 
           " wasn't searched for in ", input$year, ". Reverting to All species."),
    duration = 4,
    type = "error"
  )

  return(leaflet() %>% 
           addTiles() %>% 
           setView(lng = -122.649791, lat = 52.813212, zoom = 6) %>%
           addPolygons(
             data = HSDA_layer,  
             fillColor = "#D3D3D3",  
             weight = 1,
             opacity = 0.8,
             color = "#696868",
             fillOpacity = 0.75, 
             label = NULL
           ))
}

  
  # Get unique values in selected data
  unique_values <- unique(data[[species_col]][!is.na(data[[species_col]])])
  
  # Determine color binning 
  if (length(unique_values) == 1) {
    # If only one unique value
    pal <- colorFactor(palette = c("#D3D3D3", "#FFEDA0"), domain = unique_values)
  } else {
    
    min_value <- min(data[[species_col]], na.rm = TRUE)
    max_value <- max(data[[species_col]], na.rm = TRUE)
    bins <- pretty(c(min_value, max_value), n = 5)
    pal <- colorBin(palette = "YlOrRd", domain = data[[species_col]], bins = bins, na.color = "#D3D3D3")
  }
  
  # hover label
  data$tooltip <- paste0(
    "<b>", data$HSDA, "<\u002fb><br>",
    "Year: ", input$year, "<br>",
    "Species: ", paste(selected_species(), collapse = ", "), "<br>",
    "Mosquito Count: ", format(data[[species_col]], big.mark = ",")
  )
  
  # Leaflet map
  leaflet(data) %>%
    addTiles() %>%
    setView(lng = -122.649791, lat = 52.813212, zoom = 6) %>%
    
    addPolygons(
      data = HSDA_layer,  
      fillColor = "#D3D3D3",  
      weight = 1,
      opacity = 0.8,
      color = "#696868",
      fillOpacity = 0.75, 
      label = NULL
    )  %>%
    
    addPolygons(
      fillColor = ~pal(get(species_col)),  
      weight = 1,
      opacity = 1,
      color = "#696868",
      fillOpacity = 0.7,
      highlightOptions = highlightOptions(
        weight = 4,
        color = "#46ebeb",
        bringToFront = TRUE
      ),
      label = ~lapply(tooltip, htmltools::HTML), 
      labelOptions = labelOptions(
        style = list("font-weight" = "normal", "font-size" = "12px"),
        textsize = "12px",
        direction = "auto"
      )
    ) %>%
    addLegend(
      pal = pal,
      values = data[[species_col]],
      title = paste("Mosquito Count:", paste(selected_species(), collapse = ","), input$year),
      position = "bottomleft",
      opacity = 0.8,
      labFormat = labelFormat(
        big.mark = ",", 
        digits = 0,     
        transform = function(x) round(x)
      )
    )
})


</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["header-attrs"]},{"type":"character","attributes":{},"value":["2.28"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pandoc"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["header-attrs.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.28"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/yeti.min.css"]},{"type":"character","attributes":{},"value":["<style>h1 {font-size: 34px;}\n       h1.title {font-size: 38px;}\n       h2 {font-size: 30px;}\n       h3 {font-size: 24px;}\n       h4 {font-size: 18px;}\n       h5 {font-size: 16px;}\n       h6 {font-size: 12px;}\n       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}\n       pre:not([class]) { background-color: white }<\/style>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.28"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.28"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.28"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bslib-component-js"]},{"type":"character","attributes":{},"value":["0.8.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["components/dist"]}]},{"type":"NULL"},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["src"]}},"value":[{"type":"character","attributes":{},"value":["components.min.js"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["src","type"]}},"value":[{"type":"character","attributes":{},"value":["web-components.min.js"]},{"type":"character","attributes":{},"value":["module"]}]}]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["bslib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bslib-component-css"]},{"type":"character","attributes":{},"value":["0.8.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["components/dist"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["components.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["bslib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bslib-tag-require"]},{"type":"character","attributes":{},"value":["0.8.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["components"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tag-require.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["bslib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bslib-component-js"]},{"type":"character","attributes":{},"value":["0.8.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["components/dist"]}]},{"type":"NULL"},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["src"]}},"value":[{"type":"character","attributes":{},"value":["components.min.js"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["src","type"]}},"value":[{"type":"character","attributes":{},"value":["web-components.min.js"]},{"type":"character","attributes":{},"value":["module"]}]}]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["bslib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bslib-component-css"]},{"type":"character","attributes":{},"value":["0.8.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["components/dist"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["components.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["bslib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bslib-tag-require"]},{"type":"character","attributes":{},"value":["0.8.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["components"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tag-require.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["bslib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["1.9.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bslib-component-js"]},{"type":"character","attributes":{},"value":["0.8.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["components/dist"]}]},{"type":"NULL"},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["src"]}},"value":[{"type":"character","attributes":{},"value":["components.min.js"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["src","type"]}},"value":[{"type":"character","attributes":{},"value":["web-components.min.js"]},{"type":"character","attributes":{},"value":["module"]}]}]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["bslib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bslib-component-css"]},{"type":"character","attributes":{},"value":["0.8.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["components/dist"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["components.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["bslib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.9.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.10.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.10.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"character","attributes":{},"value":["0.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["href","file"]}},"value":[{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"character","attributes":{},"value":["assets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets-bindings.min.js"]},{"type":"character","attributes":{},"value":["shinyWidgets.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.9.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-select"]},{"type":"character","attributes":{},"value":["1.13.8"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["href","file"]}},"value":[{"type":"character","attributes":{},"value":["shinyWidgets/bootstrap-select"]},{"type":"character","attributes":{},"value":["assets/bootstrap-select"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/bootstrap-select.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap-select.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.9.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bslib-tag-require"]},{"type":"character","attributes":{},"value":["0.8.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["components"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tag-require.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["bslib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.4.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","accessibility/js/bootstrap-accessibility.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css","accessibility/css/bootstrap-accessibility.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.9.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.9.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.9.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.9.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"character","attributes":{},"value":["0.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["href","file"]}},"value":[{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"character","attributes":{},"value":["assets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets-bindings.min.js"]},{"type":"character","attributes":{},"value":["shinyWidgets.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.9.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-select"]},{"type":"character","attributes":{},"value":["1.13.8"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["href","file"]}},"value":[{"type":"character","attributes":{},"value":["shinyWidgets/bootstrap-select"]},{"type":"character","attributes":{},"value":["assets/bootstrap-select"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/bootstrap-select.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap-select.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.9.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["leaflet"]},{"type":"character","attributes":{},"value":["1.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/leaflet"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet.js"]},{"type":"character","attributes":{},"value":["leaflet.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["leafletfix"]},{"type":"character","attributes":{},"value":["1.0.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/leafletfix"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leafletfix.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["proj4"]},{"type":"character","attributes":{},"value":["2.6.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/plugins/Proj4Leaflet"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["proj4.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["Proj4Leaflet"]},{"type":"character","attributes":{},"value":["1.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/plugins/Proj4Leaflet"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["proj4leaflet.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["rstudio_leaflet"]},{"type":"character","attributes":{},"value":["1.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/rstudio_leaflet"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rstudio_leaflet.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["leaflet-binding"]},{"type":"character","attributes":{},"value":["2.2.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/assets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.9.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"character","attributes":{},"value":["0.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["href","file"]}},"value":[{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"character","attributes":{},"value":["assets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets-bindings.min.js"]},{"type":"character","attributes":{},"value":["shinyWidgets.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.9.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-select"]},{"type":"character","attributes":{},"value":["1.13.8"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["href","file"]}},"value":[{"type":"character","attributes":{},"value":["shinyWidgets/bootstrap-select"]},{"type":"character","attributes":{},"value":["assets/bootstrap-select"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/bootstrap-select.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap-select.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.9.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"character","attributes":{},"value":["0.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["href","file"]}},"value":[{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"character","attributes":{},"value":["assets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets-bindings.min.js"]},{"type":"character","attributes":{},"value":["shinyWidgets.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.9.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["6.4.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.min.css","css/v4-shims.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fontawesome"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["datatables-css"]},{"type":"character","attributes":{},"value":["0.0.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/css"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["datatables-crosstalk.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["DT"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.33"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["datatables-binding"]},{"type":"character","attributes":{},"value":["0.33"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["datatables.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["DT"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.33"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["crosstalk"]},{"type":"character","attributes":{},"value":["1.2.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/crosstalk.min.js"]},{"type":"character","attributes":{},"value":["css/crosstalk.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["crosstalk"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.2.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["leaflet"]},{"type":"character","attributes":{},"value":["1.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/leaflet"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet.js"]},{"type":"character","attributes":{},"value":["leaflet.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["leafletfix"]},{"type":"character","attributes":{},"value":["1.0.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/leafletfix"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leafletfix.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["proj4"]},{"type":"character","attributes":{},"value":["2.6.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/plugins/Proj4Leaflet"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["proj4.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["Proj4Leaflet"]},{"type":"character","attributes":{},"value":["1.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/plugins/Proj4Leaflet"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["proj4leaflet.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["rstudio_leaflet"]},{"type":"character","attributes":{},"value":["1.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/rstudio_leaflet"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rstudio_leaflet.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["leaflet-binding"]},{"type":"character","attributes":{},"value":["2.2.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/assets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2.2.2"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131]}},"value":[{"type":"character","attributes":{},"value":["abind","base","base64enc","bcdata","bcmaps","bsicons","bslib","cachem","cellranger","class","classInt","cli","codetools","colorspace","compiler","crosstalk","crul","curl","data.table","datasets","DBI","dbplyr","dichromat","digest","dplyr","DT","e1071","evaluate","fansi","fastmap","fontawesome","forcats","generics","geojsonsf","ggplot2","glue","graphics","grDevices","grid","gt","gtable","here","hms","htmltools","htmlwidgets","httpcode","httpuv","httr","janitor","jquerylib","jsonlite","KernSmooth","knitr","later","lattice","lazyeval","leafem","leaflet","leaflet.providers","leafsync","lifecycle","lubridate","lwgeom","magrittr","memoise","methods","mime","munsell","parallel","pillar","pkgconfig","plotly","png","prettymapr","promises","proxy","purrr","R.methodsS3","R.oo","R.utils","R6","raster","RColorBrewer","Rcpp","readr","readxl","renv","rio","rlang","rmapshaper","rmarkdown","rprojroot","rstudioapi","sass","scales","sf","shiny","shinyalert","shinyjs","shinyWidgets","snakecase","sp","stars","stats","stringi","stringr","terra","tibble","tidyr","tidyselect","tidyverse","timechange","tmap","tmaptools","tools","triebeard","tzdb","units","urltools","utf8","utils","V8","vctrs","viridisLite","withr","writexl","xfun","XML","xml2","xtable","yaml"]},{"type":"character","attributes":{},"value":["1.4-8","4.3.1","0.1-3","0.5.0","2.2.1","0.1.2","0.8.0","1.1.0","1.1.0","7.3-22","0.4-11","3.6.3","0.2-19","2.1-1","4.3.1","1.2.1","1.5.0","6.2.3","1.16.0","4.3.1","1.2.3","2.5.0","2.0-0.1","0.6.37","1.1.4","0.33","1.7-16","1.0.3","1.0.6","1.2.0","0.5.2","1.0.0","0.1.3","2.0.3","3.5.1","1.7.0","4.3.1","4.3.1","4.3.1","0.11.0","0.3.5","1.0.1","1.1.3","0.5.8.1","1.6.4","0.3.0","1.6.15","1.4.7","2.2.0","0.1.4","1.8.9","2.23-21","1.48","1.4.1","0.21-8","0.2.2","0.2.3","2.2.2","2.0.0","0.1.0","1.0.4","1.9.3","0.2-14","2.0.3","2.0.1","4.3.1","0.12","0.5.1","4.3.1","1.9.0","2.0.3","4.10.4","0.1-8","0.2.5","1.3.2","0.4-27","1.0.2","1.8.2","1.26.0","2.12.3","2.5.1","3.6-31","1.1-3","1.0.13","2.1.5","1.4.3","1.0.11","1.2.3","1.1.4","0.5.0","2.28","2.0.4","0.16.0","0.4.9","1.3.0","1.0-19","1.9.1","3.1.0","2.1.0","0.9.0","0.11.1","2.1-4","0.6-7","4.3.1","1.8.4","1.5.1","1.8-10","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","3.3-4","3.2","4.3.1","0.4.1","0.4.0","0.8-5","1.7.3","1.2.4","4.3.1","5.0.1","0.6.5","0.4.2","3.0.2","1.5.0","0.47","3.99-0.18","1.3.6","1.8-4","2.3.10"]}]}]}
</script>
<!--/html_preserve-->

<body>
    <p style="background-color: #004987; height: 80px;">
      
      <a href="http://www.bccdc.ca/">
        <img src="images/BCCDC_Logo_White_900px.png" alt="Left Logo"
          title="Left Logo" style="height: 48px;  margin-top: 22px; margin-left: 4%;">
      </a>
      
       <a href="http://www.phsa.ca/">
        <img src="images/phsa-white-horizontal.png" alt="Right Logo"
          title="Right Logo" style="height: 48px;  margin-top: 16px; float: right; margin-right: 4%;">
      </a>
    </p>
</body>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
